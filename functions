# Get lines section '[section]' from config file to aother file

def copy_section(conf, file, section):
  sectionFlag = 0
  section_delimeter ="[" + section + "]"
  with open(conf) as conf_file :
    with open(file, "w") as output_file:
      for line in conf_file :
        line_no_new_line = line.rstrip()
        if line_no_new_line == section_delimeter and  sectionFlag == 0:
          sectionFlag = 1
          continue
        if sectionFlag == 1:
          if not line_no_new_line.startswith('['):
            output_file.write(line)
          else:
            return


# Check section names repeating in config file

def check_sections_in_conf_file(conf):
  list_del = []
  with open(conf) as f:
    for line in f:
      line = line.strip()
      if line.startswith('[') and line.endswith(']'):
        list_del.append(line)
    print(f"Section list = '{','.join(list_del)}'")
    if len(list_del) != len(set(list_del)):
      print(f"***ERROR: duplicate section names")
    else:
     print(f"No error founds")

# Find string that start [ and alfa

import re

def find():
  string = '[kuku]'
  if re.match("^\[[a-zA-Z]+.*", string):
    print(f"string '{string}'")
    
# Create directory if not exists

import os
from pathlib import Path
from shutil import copyfile


ansible_roles_dir = "/opt/ansible/roles"


def check_if_dir_not_exists_create_it(directorypath):
  print(f"**Check if directory exists '{directorypath}'")
  print(f"{Path(directorypath).is_dir()}")
  if Path(directorypath).is_dir():
    print(f"Directory exists")
  else:
    print(f"Creating directory")
    os.makedirs(directorypath, 755)

def create_role(role_name):
  
  print(f"Create role '{role_name}'")
  print(f"**Create role directory '{role_name}'")
  role_dir = ansible_roles_dir + '/' + role_name + '/task'
  role_file = role_dir + '/main.yaml'
  tmp_file = '/tmp/role'
  
  check_if_dir_not_exists_create_it(role_dir)
  
  print(f"**Create role file '{role_file}'")
  copyfile(tmp_file, role_file)
  
  
create_role("kuku")


# create list

import re

pattern = "^\[role:.*\]"

role_list=[]
file = open("/tmp/text", "r")
for line in file:
    if re.search(pattern, line):
        line.rsplit()
        line=line[6:-2]
        role_list.append(line)
        print(role_list)
