import subprocess

ipmitool = "/usr/bin/ipmitool"
get_ipmitool = "lan print"
setipmitool = "lan print"
get = "get"
set = "set"
dhcp_static = "IP Address Source"
ipaddr = "IP Address"
netmask = "Subnet Mask"
default_gateway = "Default Gateway IP"

def ipmitool_lan(set_get, cmd, para = None):

        ipmi_cmd = ipmitool + " " + cmd
        if set_get == "get":
                proc = subprocess.Popen(ipmi_cmd.split(), stdout=subprocess.PIPE)
                for line in proc.stdout.readlines():
                        if line.startswith(para + "  "):
                                value_str = line.split(":",1)[1]
                                value_str = value_str.split()[0]
                                break
        return value_str

# DHCP_STATIC = ipmitool_lan(get, get_ipmitool, dhcp_static)
# print "DHCP_STATIC = " + str(DHCP_STATIC)
# IPADDR = ipmitool_lan(get, get_ipmitool, ipaddr)
# print "IPADDR = " + str(IPADDR)
# NETMASK = ipmitool_lan(get, get_ipmitool, netmask)
# print "NETMASK = " + str(NETMASK)
# DEFULT_GATEWAY = ipmitool_lan(get, get_ipmitool, default_gateway)
# print "DEFULT_GATEWAY = " + str(DEFULT_GATEWAY)
